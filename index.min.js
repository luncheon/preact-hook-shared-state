import{useEffect as e,useState as t}from"preact/hooks";const r=[];export const createSharedState=o=>{const a=new Set,n=()=>{const n=t()[1];return e(()=>(a.add(n),()=>a.delete(n)),r),o};return n.listeners=a,n.snapshot=()=>o,[n,e=>{o="function"==typeof e?e(o):e,a.forEach(e=>e(o))}]};export const createSharedSelector=(e,t)=>{const r=()=>t(...e.map(e=>e.snapshot())),[o,a]=createSharedState(r()),n=()=>a(r());return e.forEach(e=>e.listeners.add(n)),o};