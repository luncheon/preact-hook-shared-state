import{useEffect as t,useState as e}from"preact/hooks";const o=[];export const createSharedState=r=>{const n=new Set,s=()=>{const s=e()[1];return t(()=>(n.add(s),()=>n.delete(s)),o),r};return s.listeners=n,s.snapshot=()=>r,[s,t=>{r="function"==typeof t?t(r):t,n.forEach(t=>t(r))}]};export const createSharedSelector=(r,n)=>{let s=n(...r.map(t=>t.snapshot()));const a=new Set,c=()=>{s=n(...r.map(t=>t.snapshot())),a.forEach(t=>t(s))};r.forEach(t=>t.listeners.add(c));const p=()=>{const r=e()[1];return t(()=>(a.add(r),()=>a.delete(r)),o),s};return p.listeners=a,p.snapshot=()=>s,p};